Блокировка AJAX XHR ЗАПРОСОВ

Блокировка запросов к обменнику, чтобы нельзя было через XHR из консоли пулять запросы бесконтрольно, пока выполняется первый запрос

1. У юзера создать поле users.lock = TIMESTAMP default '2001-01-01';

2. делаемзапрос () {
//проверяем что текущее время больше чем время лока + 10 секунд
if (now() > users.lock + 10sec) {
    //обновляемся чтобы никто за нами не прошел
    update users.lock = now();
    //тут далее пошел смысловой запрос к обменнику
  }
  else {
  exit (10 секунд не прошло);
  }
}